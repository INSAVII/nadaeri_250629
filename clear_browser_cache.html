<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>브라우저 캐시 완전 정리</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .button {
            background: #dc3545;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
            transition: background-color 0.3s;
        }

        .button:hover {
            background: #c82333;
        }

        .button.success {
            background: #28a745;
        }

        .button.success:hover {
            background: #218838;
        }

        .info {
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }

        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }

        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }

        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-weight: bold;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>🧹 브라우저 캐시 완전 정리 도구</h1>

        <div class="info">
            <h3>📋 정리 대상</h3>
            <ul>
                <li><strong>localStorage</strong> - 모든 키-값 쌍 삭제</li>
                <li><strong>sessionStorage</strong> - 모든 키-값 쌍 삭제</li>
                <li><strong>쿠키</strong> - 현재 도메인의 모든 쿠키 삭제</li>
                <li><strong>캐시</strong> - 브라우저 캐시 정리</li>
            </ul>
        </div>

        <div class="warning">
            <h3>⚠️ 주의사항</h3>
            <p>이 도구는 현재 도메인의 모든 브라우저 데이터를 삭제합니다. 로그인 정보, 설정, 기타 저장된 데이터가 모두 사라집니다.</p>
        </div>

        <div>
            <button class="button" onclick="clearAllData()">🚨 모든 데이터 완전 삭제</button>
            <button class="button success" onclick="clearAuthData()">🔐 인증 데이터만 삭제</button>
            <button class="button" onclick="showCurrentData()">📊 현재 데이터 확인</button>
        </div>

        <div id="status"></div>
        <div id="log" class="log" style="display: none;"></div>
    </div>

    <script>
        function log(message) {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.innerHTML += `[${timestamp}] ${message}\n`;
            logDiv.style.display = 'block';
            logDiv.scrollTop = logDiv.scrollHeight;
            console.log(message);
        }

        function showStatus(message, type = 'success') {
            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
        }

        function clearAllData() {
            if (!confirm('정말로 모든 브라우저 데이터를 삭제하시겠습니까?\n\n이 작업은 되돌릴 수 없습니다!')) {
                return;
            }

            log('=== 모든 데이터 삭제 시작 ===');

            try {
                // localStorage 정리
                const localStorageKeys = Object.keys(localStorage);
                log(`localStorage 키 개수: ${localStorageKeys.length}`);
                localStorageKeys.forEach(key => {
                    log(`삭제: localStorage['${key}']`);
                    localStorage.removeItem(key);
                });
                log('localStorage 완전 정리 완료');

                // sessionStorage 정리
                const sessionStorageKeys = Object.keys(sessionStorage);
                log(`sessionStorage 키 개수: ${sessionStorageKeys.length}`);
                sessionStorageKeys.forEach(key => {
                    log(`삭제: sessionStorage['${key}']`);
                    sessionStorage.removeItem(key);
                });
                log('sessionStorage 완전 정리 완료');

                // 쿠키 정리
                const cookies = document.cookie.split(';');
                log(`쿠키 개수: ${cookies.length}`);
                cookies.forEach(cookie => {
                    const name = cookie.split('=')[0].trim();
                    if (name) {
                        log(`쿠키 삭제: ${name}`);
                        document.cookie = `${name}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`;
                    }
                });
                log('쿠키 완전 정리 완료');

                // 캐시 정리 (가능한 경우)
                if ('caches' in window) {
                    caches.keys().then(cacheNames => {
                        log(`캐시 개수: ${cacheNames.length}`);
                        cacheNames.forEach(cacheName => {
                            log(`캐시 삭제: ${cacheName}`);
                            caches.delete(cacheName);
                        });
                        log('캐시 완전 정리 완료');
                    });
                } else {
                    log('캐시 API를 사용할 수 없습니다');
                }

                log('=== 모든 데이터 삭제 완료 ===');
                showStatus('✅ 모든 브라우저 데이터가 성공적으로 삭제되었습니다!', 'success');

                // 3초 후 페이지 새로고침
                setTimeout(() => {
                    log('페이지를 새로고침합니다...');
                    window.location.reload();
                }, 3000);

            } catch (error) {
                log(`오류 발생: ${error.message}`);
                showStatus(`❌ 오류가 발생했습니다: ${error.message}`, 'error');
            }
        }

        function clearAuthData() {
            if (!confirm('인증 관련 데이터만 삭제하시겠습니까?')) {
                return;
            }

            log('=== 인증 데이터 삭제 시작 ===');

            try {
                const authKeys = [
                    'USER_DATA',
                    'currentUser',
                    'authUser',
                    'mockUsers',
                    'LOGIN_TIME',
                    'forceLogout',
                    'forceInit',
                    'FETCHING_PERMISSIONS',
                    'ACTIVE_PROGRAMS'
                ];

                // localStorage에서 인증 관련 키 삭제
                authKeys.forEach(key => {
                    if (localStorage.getItem(key)) {
                        log(`삭제: localStorage['${key}']`);
                        localStorage.removeItem(key);
                    }
                });

                // sessionStorage에서 인증 관련 키 삭제
                authKeys.forEach(key => {
                    if (sessionStorage.getItem(key)) {
                        log(`삭제: sessionStorage['${key}']`);
                        sessionStorage.removeItem(key);
                    }
                });

                // 인증 관련 쿠키 삭제
                const authCookies = ['token', 'auth', 'session'];
                authCookies.forEach(cookieName => {
                    document.cookie = `${cookieName}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`;
                    log(`쿠키 삭제: ${cookieName}`);
                });

                log('=== 인증 데이터 삭제 완료 ===');
                showStatus('✅ 인증 데이터가 성공적으로 삭제되었습니다!', 'success');

                // 2초 후 페이지 새로고침
                setTimeout(() => {
                    log('페이지를 새로고침합니다...');
                    window.location.reload();
                }, 2000);

            } catch (error) {
                log(`오류 발생: ${error.message}`);
                showStatus(`❌ 오류가 발생했습니다: ${error.message}`, 'error');
            }
        }

        function showCurrentData() {
            log('=== 현재 데이터 확인 ===');

            // localStorage 확인
            const localStorageKeys = Object.keys(localStorage);
            log(`localStorage 키 개수: ${localStorageKeys.length}`);
            localStorageKeys.forEach(key => {
                const value = localStorage.getItem(key);
                const preview = value ? value.substring(0, 100) + (value.length > 100 ? '...' : '') : 'null';
                log(`localStorage['${key}'] = ${preview}`);
            });

            // sessionStorage 확인
            const sessionStorageKeys = Object.keys(sessionStorage);
            log(`sessionStorage 키 개수: ${sessionStorageKeys.length}`);
            sessionStorageKeys.forEach(key => {
                const value = sessionStorage.getItem(key);
                const preview = value ? value.substring(0, 100) + (value.length > 100 ? '...' : '') : 'null';
                log(`sessionStorage['${key}'] = ${preview}`);
            });

            // 쿠키 확인
            const cookies = document.cookie.split(';');
            log(`쿠키 개수: ${cookies.length}`);
            cookies.forEach(cookie => {
                if (cookie.trim()) {
                    log(`쿠키: ${cookie.trim()}`);
                }
            });

            log('=== 데이터 확인 완료 ===');
            showStatus('📊 현재 데이터 정보가 로그에 표시되었습니다.', 'success');
        }

        // 페이지 로드 시 현재 데이터 자동 표시
        window.onload = function () {
            log('브라우저 캐시 정리 도구가 로드되었습니다.');
            log(`현재 URL: ${window.location.href}`);
            log(`현재 도메인: ${window.location.hostname}`);
        };
    </script>
</body>

</html>

</html>