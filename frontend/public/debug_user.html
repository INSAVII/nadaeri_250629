<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‚¬ìš©ì ìƒíƒœ ë””ë²„ê·¸</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }

        .success {
            background-color: #d4edda;
            color: #155724;
        }

        .error {
            background-color: #f8d7da;
            color: #721c24;
        }

        .info {
            background-color: #d1ecf1;
            color: #0c5460;
        }

        .warning {
            background-color: #fff3cd;
            color: #856404;
        }

        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }

        button:hover {
            background-color: #0056b3;
        }

        .log {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 10px;
            border-radius: 4px;
            max-height: 400px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }

        .data-display {
            background-color: #e9ecef;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>ğŸ” ì‚¬ìš©ì ìƒíƒœ ë””ë²„ê·¸</h1>

        <div id="status" class="status info">
            ìƒíƒœ í™•ì¸ ì¤‘...
        </div>

        <div>
            <h3>ì‚¬ìš©ì ë°ì´í„°:</h3>
            <div id="userData" class="data-display">
                ë¡œë”© ì¤‘...
            </div>
        </div>

        <div>
            <h3>localStorage ë°ì´í„°:</h3>
            <div id="localStorageData" class="data-display">
                ë¡œë”© ì¤‘...
            </div>
        </div>

        <div>
            <h3>ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ ë°ì´í„°:</h3>
            <div id="sessionStorageData" class="data-display">
                ë¡œë”© ì¤‘...
            </div>
        </div>

        <div>
            <h3>ì‘ì—…:</h3>
            <button onclick="refreshData()">ë°ì´í„° ìƒˆë¡œê³ ì¹¨</button>
            <button onclick="clearAllData()">ëª¨ë“  ë°ì´í„° ì‚­ì œ</button>
            <button onclick="clearUserData()">ì‚¬ìš©ì ë°ì´í„°ë§Œ ì‚­ì œ</button>
            <button onclick="reloadPage()">í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨</button>
        </div>

        <div>
            <h3>ë¡œê·¸:</h3>
            <div id="log" class="log"></div>
        </div>
    </div>

    <script>
        const logElement = document.getElementById('log');
        const statusElement = document.getElementById('status');
        const userDataElement = document.getElementById('userData');
        const localStorageElement = document.getElementById('localStorageData');
        const sessionStorageElement = document.getElementById('sessionStorageData');

        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}`;
            logElement.innerHTML += logEntry + '\n';
            logElement.scrollTop = logElement.scrollHeight;
            console.log(logEntry);
        }

        function updateStatus(message, type = 'info') {
            statusElement.textContent = message;
            statusElement.className = `status ${type}`;
        }

        function displayUserData() {
            try {
                // localStorageì—ì„œ ì‚¬ìš©ì ë°ì´í„° í™•ì¸
                const userData = localStorage.getItem('USER_DATA');
                let userInfo = 'ì‚¬ìš©ì ë°ì´í„° ì—†ìŒ';

                if (userData) {
                    const parsed = JSON.parse(userData);
                    userInfo = JSON.stringify(parsed, null, 2);
                    log('ì‚¬ìš©ì ë°ì´í„° ë°œê²¬: ' + parsed.role);
                } else {
                    log('ì‚¬ìš©ì ë°ì´í„° ì—†ìŒ');
                }

                userDataElement.innerHTML = `<pre>${userInfo}</pre>`;

                // localStorage ì „ì²´ ë°ì´í„°
                const allLocalStorage = {};
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key) {
                        allLocalStorage[key] = localStorage.getItem(key);
                    }
                }
                localStorageElement.innerHTML = `<pre>${JSON.stringify(allLocalStorage, null, 2)}</pre>`;

                // sessionStorage ì „ì²´ ë°ì´í„°
                const allSessionStorage = {};
                for (let i = 0; i < sessionStorage.length; i++) {
                    const key = sessionStorage.key(i);
                    if (key) {
                        allSessionStorage[key] = sessionStorage.getItem(key);
                    }
                }
                sessionStorageElement.innerHTML = `<pre>${JSON.stringify(allSessionStorage, null, 2)}</pre>`;

                updateStatus('ë°ì´í„° ë¡œë“œ ì™„ë£Œ', 'success');
            } catch (error) {
                log('ì˜¤ë¥˜ ë°œìƒ: ' + error.message);
                updateStatus('ë°ì´í„° ë¡œë“œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ', 'error');
            }
        }

        function clearAllData() {
            try {
                localStorage.clear();
                sessionStorage.clear();
                log('ëª¨ë“  ë°ì´í„° ì‚­ì œ ì™„ë£Œ');
                updateStatus('ëª¨ë“  ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤', 'warning');
                displayUserData();
            } catch (error) {
                log('ë°ì´í„° ì‚­ì œ ì˜¤ë¥˜: ' + error.message);
                updateStatus('ë°ì´í„° ì‚­ì œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ', 'error');
            }
        }

        function clearUserData() {
            try {
                localStorage.removeItem('USER_DATA');
                localStorage.removeItem('user');
                localStorage.removeItem('mockUsers');
                localStorage.removeItem('currentUser');
                localStorage.removeItem('authUser');
                localStorage.removeItem('userToken');
                localStorage.removeItem('accessToken');
                sessionStorage.removeItem('userData');
                sessionStorage.removeItem('authToken');
                sessionStorage.removeItem('forceLogout');
                log('ì‚¬ìš©ì ë°ì´í„° ì‚­ì œ ì™„ë£Œ');
                updateStatus('ì‚¬ìš©ì ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤', 'warning');
                displayUserData();
            } catch (error) {
                log('ì‚¬ìš©ì ë°ì´í„° ì‚­ì œ ì˜¤ë¥˜: ' + error.message);
                updateStatus('ì‚¬ìš©ì ë°ì´í„° ì‚­ì œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ', 'error');
            }
        }

        function refreshData() {
            log('ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì‹œì‘');
            displayUserData();
        }

        function reloadPage() {
            log('í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ì‹¤í–‰');
            window.location.reload();
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.addEventListener('load', () => {
            log('ì‚¬ìš©ì ìƒíƒœ ë””ë²„ê·¸ í˜ì´ì§€ ë¡œë“œë¨');
            displayUserData();
        });

        // ì—ëŸ¬ ì²˜ë¦¬
        window.addEventListener('error', (event) => {
            log(`âŒ ì˜¤ë¥˜ ë°œìƒ: ${event.error}`);
            updateStatus('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤', 'error');
        });
    </script>
</body>

</html>