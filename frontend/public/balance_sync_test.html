<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜ˆì¹˜ê¸ˆ ë™ê¸°í™” í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }

        .success {
            background-color: #d4edda;
            color: #155724;
        }

        .error {
            background-color: #f8d7da;
            color: #721c24;
        }

        .info {
            background-color: #d1ecf1;
            color: #0c5460;
        }

        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }

        button:hover {
            background-color: #0056b3;
        }

        .log {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 10px;
            border-radius: 4px;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>ğŸ’° ì˜ˆì¹˜ê¸ˆ ë™ê¸°í™” í…ŒìŠ¤íŠ¸</h1>

        <div id="status" class="status info">
            í…ŒìŠ¤íŠ¸ ì¤€ë¹„ ì¤‘...
        </div>

        <div>
            <h3>í…ŒìŠ¤íŠ¸ ë°©ë²•:</h3>
            <ol>
                <li>ì´ í˜ì´ì§€ë¥¼ ì—´ì–´ë‘” ìƒíƒœì—ì„œ CMS í˜ì´ì§€ë¡œ ì´ë™</li>
                <li>CMSì—ì„œ í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ ì˜ˆì¹˜ê¸ˆì„ ë³€ê²½</li>
                <li>ì´ í˜ì´ì§€ë¡œ ëŒì•„ì™€ì„œ ë™ê¸°í™” ìƒíƒœ í™•ì¸</li>
            </ol>
        </div>

        <div>
            <h3>ìˆ˜ë™ í…ŒìŠ¤íŠ¸:</h3>
            <button onclick="testBalanceEvent()">ì˜ˆì¹˜ê¸ˆ ë³€ê²½ ì´ë²¤íŠ¸ í…ŒìŠ¤íŠ¸</button>
            <button onclick="clearLog()">ë¡œê·¸ ì§€ìš°ê¸°</button>
        </div>

        <div>
            <h3>ì´ë²¤íŠ¸ ë¡œê·¸:</h3>
            <div id="log" class="log"></div>
        </div>
    </div>

    <script>
        let eventCount = 0;
        const logElement = document.getElementById('log');
        const statusElement = document.getElementById('status');

        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}`;
            logElement.innerHTML += logEntry + '\n';
            logElement.scrollTop = logElement.scrollHeight;
            console.log(logEntry);
        }

        function updateStatus(message, type = 'info') {
            statusElement.textContent = message;
            statusElement.className = `status ${type}`;
        }

        function testBalanceEvent() {
            eventCount++;
            const testEvent = new CustomEvent('balanceChanged', {
                detail: {
                    userId: 'test-user',
                    newBalance: 50000 + (eventCount * 1000),
                    source: 'TestPage',
                    timestamp: new Date().toISOString()
                }
            });

            log(`ğŸ§ª í…ŒìŠ¤íŠ¸ ì´ë²¤íŠ¸ ë°œìƒ: ${testEvent.detail.newBalance}ì›`);
            window.dispatchEvent(testEvent);
        }

        function clearLog() {
            logElement.innerHTML = '';
            log('ë¡œê·¸ê°€ ì§€ì›Œì¡ŒìŠµë‹ˆë‹¤.');
        }

        // ì˜ˆì¹˜ê¸ˆ ë³€ê²½ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        window.addEventListener('balanceChanged', (event) => {
            const { userId, newBalance, source, timestamp } = event.detail;
            log(`ğŸ’° ì˜ˆì¹˜ê¸ˆ ë³€ê²½ ì´ë²¤íŠ¸ ìˆ˜ì‹ :`);
            log(`   ì‚¬ìš©ì ID: ${userId}`);
            log(`   ìƒˆë¡œìš´ ì”ì•¡: ${newBalance.toLocaleString()}ì›`);
            log(`   ì¶œì²˜: ${source}`);
            log(`   ì‹œê°„: ${new Date(timestamp).toLocaleString()}`);
            log('---');

            updateStatus(`ì˜ˆì¹˜ê¸ˆ ë³€ê²½ ê°ì§€: ${newBalance.toLocaleString()}ì› (${source})`, 'success');
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.addEventListener('load', () => {
            log('ğŸš€ ì˜ˆì¹˜ê¸ˆ ë™ê¸°í™” í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ë¡œë“œë¨');
            log('ğŸ“¡ balanceChanged ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ë¨');
            updateStatus('í…ŒìŠ¤íŠ¸ ì¤€ë¹„ ì™„ë£Œ - CMSì—ì„œ ì˜ˆì¹˜ê¸ˆ ë³€ê²½ì„ ì‹œë„í•´ë³´ì„¸ìš”', 'success');
        });

        // ì—ëŸ¬ ì²˜ë¦¬
        window.addEventListener('error', (event) => {
            log(`âŒ ì˜¤ë¥˜ ë°œìƒ: ${event.error}`);
            updateStatus('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤', 'error');
        });
    </script>
</body>

</html>